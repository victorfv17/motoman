<!--Pantalla de comprar pilotos-->
<ng-container *ngIf="isLoading; then spinner; else table"></ng-container>
<ng-template #spinner>
    <mat-spinner class="spinner-center"></mat-spinner>
</ng-template>
<ng-template #table>

    <div class="title">
        <h1>Comprar pilotos</h1>

        <mat-card class="card" style="margin-top:10px;margin-right: 50px;">
            <mat-icon style="font-size: 20px;">
                account_balance
            </mat-icon>
            <mat-card-title>
                Saldo:
                <span>
                    {{usuario.saldo}}
                </span>
            </mat-card-title>

        </mat-card>
        <mat-card class="card" style="margin-top:10px;margin-right: 50px;">
            <mat-icon style="font-size: 20px;">
                account_balance
            </mat-icon>
            <mat-card-title>
                Saldo Restante:
                <span>
                    {{usuario.saldoRestante}}
                </span>
            </mat-card-title>

        </mat-card>



    </div>
    <form #formPilotos="ngForm">
        <mat-card style="margin:10px;">
            <table class="table table-bordered table-hover table-striped">
                <thead class=" thead-dark">
                    <tr class="pointer text-align">
                        <th scope="col" name="piloto">Piloto
                        </th>
                        <th scope="col" name="piloto">Valor Mercado
                        </th>
                        <th scope="col" name="piloto">Puntos
                        </th>
                        <th scope="col" name="piloto">Puja
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let piloto of pilotos" class="table">
                        <td>
                            <mat-card *ngIf="piloto.escuderia !== 'white'" class="mx-auto" style="color:white"
                                [ngStyle]="{'background-color': piloto.escuderia}"><img
                                    src="assets/pilotos/{{piloto.nombre}}.png" alt="{{piloto.nombre}}" height="40"
                                    width="40"> {{piloto.nombre}}</mat-card>
                            <mat-card *ngIf="piloto.escuderia === 'white'" class="mx-auto" style="color:black"
                                [ngStyle]="{'background-color': piloto.escuderia}"><img
                                    src="assets/pilotos/{{piloto.nombre}}.png" alt="{{piloto.nombre}}" height="40"
                                    width="40"> {{piloto.nombre}}</mat-card>
                        </td>
                        <td class="align-middle" style="text-align: right">
                            <mat-card class="mx-auto" style="background-color: grey;">{{piloto.valorMercado}}
                            </mat-card>
                        </td>
                        <td class="align-middle" style="text-align: right;">
                            <mat-card class="mx-auto" style="background-color: grey;">{{piloto.puntos}}
                            </mat-card>
                        </td>
                        <td class="align-middle">
                            <input matInput type="number" class="form-control mx-auto" style="width: 70%" id="puja"
                                name="{{piloto.nombre}}" placeholder="Introducir puja" [(ngModel)]="piloto.valorPuja"
                                (focusout)="coleccionPujas(piloto, piloto.valorPuja)">
                            <span class="errors" *ngIf="piloto.valorPuja && piloto.saldoMenorQuePuja"> No tienes
                                suficiente saldo para realizar esta puja</span><br>
                            <span class="errors" *ngIf="piloto.valorPuja && piloto.pujaMenorQueValorMercado "> La puja
                                es menor que el valor de mercado</span>
                        </td>
                    </tr>


                </tbody>
            </table>
            <mat-card-actions>
                <button class="btn btn-secondary submitButton " type="button"
                    (click)="limpiarDatosPujas(formPilotos)">Borrar pujas
                </button>
                <button [disabled]="formInvalid" class=" btn btn-danger submitButton " type="submit"
                    (click)="enviarPujas()" (keyup.enter)="enviarPujas()">
                    <span matTooltip="Puja invÃ¡lida" [matTooltipDisabled]="!formInvalid">
                        Enviar
                    </span>


                </button>
            </mat-card-actions>


        </mat-card>
    </form>
</ng-template>