<ng-container *ngIf="isLoading; then spinner; else table"></ng-container>
<ng-template #spinner>
    <mat-spinner class="spinner-center"></mat-spinner>
</ng-template>
<ng-template #table>
    <div class="title">
        <h1>Comprar escuderias</h1>
        <mat-card class="card" style="margin-top:10px;margin-right: 50px;">
            <mat-icon style="font-size: 20px;">
                account_balance
            </mat-icon>
            <mat-card-title>
                Saldo:
                <span>
                    {{user.usuario.saldo}}
                </span>
            </mat-card-title>
        </mat-card>

    </div>
    <form #formEscuderias="ngForm">
        <mat-card style="margin:10px;">
            <table class="table table-bordered table-hover table-striped">
                <thead class="thead-dark">
                    <tr class="pointer text-align">
                        <th scope="col" name="escuderia">Escuderia
                        </th>
                        <th scope="col" name="escuderia">Valor Mercado
                        </th>
                        <th scope="col" name="escuderia">Puntos
                        </th>
                        <th scope="col" name="escuderia">Puja
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr *ngFor="let escuderia of escuderias" class="table">
                        <td>
                            <mat-card *ngIf="escuderia.color !== 'white'" style="color:white" class="mx-auto"
                                [ngStyle]="{'background-color': escuderia.color}">
                                {{escuderia.nombre}}</mat-card>
                            <mat-card *ngIf="escuderia.color === 'white'" style="color:black" class="mx-auto"
                                [ngStyle]="{'background-color': escuderia.color}">
                                {{escuderia.nombre}}</mat-card>
                        </td>
                        <td class="align-middle" style="text-align: right">
                            <mat-card class="mx-auto" style="background-color: grey;">{{escuderia.valorMercado}}
                            </mat-card>
                        </td>
                        <td class="align-middle" style="text-align: right;">
                            <mat-card class="mx-auto" style="background-color: grey;">{{escuderia.puntos}}
                            </mat-card>
                        </td>
                        <td class="align-middle">
                            <input type="number" class="form-control mx-auto" style="width: 70%" id="puja" name="puja"
                                placeholder="Introducir puja" [(ngModel)]="escuderia.puja"
                                (ngModelChange)="coleccionPujasEscuderias(escuderia, escuderia.puja)">
                            <span class="errors" *ngIf="escuderia.puja && escuderia.saldoMenorQuePuja"> El saldo es
                                menor que la puja</span><br>
                            <span class="errors" *ngIf="escuderia.puja && escuderia.pujaMenorQueValorMercado "> La puja
                                es menor que el valor de mercado</span>
                        </td>
                    </tr>


                </tbody>
            </table>
            <mat-card-actions>
                <button class="btn btn-secondary submitButton " type="button"
                    (click)="limpiarDatosPujas(formEscuderias)">Limpiar
                </button>
                <button [disabled]="formInvalid" class="btn btn-danger submitButton " type="submit"
                    (click)="enviarPujas()" (keyup.enter)="enviarPujas()">
                    <span matTooltip="Puja invÃ¡lida" [matTooltipDisabled]="!formInvalid">
                        Enviar
                    </span>
                </button>
            </mat-card-actions>


        </mat-card>
    </form>
</ng-template>